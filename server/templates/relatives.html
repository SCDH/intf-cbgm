<div class="panel panel-closable panel-default panel-relatives" data-ms-id="{{ms.ms_id}}">

  <div class="panel-heading panel-caption panel-relatives-caption">
    <span>{{caption}}</span>
    <span data-labez="{{ms.varnew[0]}}" class="fg_labez ms hilite-source"
          data-ms-id="{{ms.ms_id}}">{{ms.hs}} ({{ms.labez}}{{ms.labezsuf}})</span>

    {% if ms.hs != 'MT' %}
    <span data-labez="{{mt.varnew[0]}}" class="fg_labez">{{_('(MT %(perc)s %(labez)s)',
    perc = "{:.2%}".format (mt.aff), labez = mt.labez + mt.labezsuf)}}</span>
    {% endif %}
  </div>

  <div class="panel-heading panel-slidable panel-toolbar panel-relatives-toolbar">
    <div class="btn-toolbar toolbar-relatives" role="toolbar">
      <div class="relatives-type btn-group btn-group-xs" data-toggle="buttons">
        <label class="btn btn-primary">
          <input type="radio" name="type" data-opt="rel">{{_('Rel')}}</input>
        </label>
        <label class="btn btn-primary">
          <input type="radio" name="type" data-opt="anc">{{_('Anc')}}</input>
        </label>
        <label class="btn btn-primary">
          <input type="radio" name="type" data-opt="des">{{_('Des')}}</input>
        </label>
      </div>

      <div class="relatives-chapter btn-group btn-group-xs" data-toggle="buttons">
        <label class="btn btn-primary">
          <input type="radio" name="chapter" data-opt="0">{{_('All')}}</input>
        </label>
        <label class="btn btn-primary">
          <input type="radio" name="chapter" data-opt="{{passage.chapter}}">{{_('Ch')}}</input>
        </label>
      </div>

      <div class="relatives-limit btn-group btn-group-xs" data-toggle="buttons">
        <label class="btn btn-primary">
          <input type="radio" name="limit" data-opt="10">10</input>
        </label>
        <label class="btn btn-primary">
          <input type="radio" name="limit" data-opt="20">20</input>
        </label>
        <label class="btn btn-primary">
          <input type="radio" name="limit" data-opt="0">{{_('All')}}</input>
        </label>
      </div>

      <div class="relatives-include btn-group btn-group-xs" data-toggle="buttons">
	    <label class="btn btn-primary">
          <input type="checkbox" name="include" data-opt="A">{{_('A')}}</input>
	    </label>
	    <label class="btn btn-primary">
          <input type="checkbox" name="include" data-opt="MT">{{_('MT')}}</input>
	    </label>
      </div>

      <div class="relatives-fragments btn-group btn-group-xs" data-toggle="buttons">
	    <label class="btn btn-primary">
          <input type="checkbox" name="fragments" data-opt="1">{{_('Frag')}}</input>
	    </label>
      </div>

      <div class="relatives-mode btn-group btn-group-xs" data-toggle="buttons">
        <label class="btn btn-primary">
          <input type="radio" name="mode" data-opt="rec">{{_('Rec')}}</input>
        </label>
        <label class="btn btn-primary">
          <input type="radio" name="mode" data-opt="sim">{{_('Sim')}}</input>
        </label>
      </div>

      <div class="relatives-labez btn-group btn-group-xs">
        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-labez bg_labez"
                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <span class="btn_text"></span> <span class="caret"></span>
        </button>
        <div class="dropdown-menu dropdown-menu-horiz dropdown-menu-labez">
          <div class="btn-group btn-group-xs" data-toggle="buttons">
            {% for v in variants %}
            <label class="btn btn-labez bg_labez" data-labez="{{v.labez|e}}">
              <input type="radio" name="labez" data-opt="{{v.labez|e}}">{{v.labez_i18n|e}}</input>
            </label>
            {% endfor %}
          </div>
        </div>
      </div>

    </div>
  </div>

  <div class="panel-slidable panel-relatives-content">
    <table class="relatives table table-condensed">
      {% for r in rows %}
      <tr data-labez="{{r.varnew[0]}}" class="fg_labez{% if loop.first %} first{% endif %}">
        <td class="rank">{{(r.rank or '')}}</td>
        <td class="direction">{{r.direction|e}}</td>
        <th class="ms"><span class="ms hilite-target" data-ms-id="{{r.ms_id}}">{{r.hs|e}}</span></th>
        <td class="perc">{{(100.0 * r.equal / r.common)|round(3)}}%</td>
        <td class="equal">{{r.equal}}/{{r.common}}</td>
        {# actually newer, older because the row is associated with the target ms #}
        <td class="older">{{r.newer}}:{{r.older}}:{{r.unclear}}:{{r.norel}}</td>
        <td class="labez">{{r.varnew}} {{r.labezsuf}}
        {%- if mt.labez == r.labez and mt.labezsuf == r.labezsuf: %} (MT){% endif -%}
        </td>
      </tr>
      {% endfor %}
    </table>
  </div>

</div>
